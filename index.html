<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDF to Base64 Converter | Client-Side Tool</title>
    <meta name="description" content="Free online tool to convert PDFs to base64 and decode base64 back to PDFs. All processing happens in your browser - no server upload required.">
    <meta name="keywords" content="pdf to base64, base64 to pdf, pdf converter, base64 encoder, base64 decoder, client-side converter">
    <meta name="author" content="PDF Tools">
    <meta name="robots" content="index, follow">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="PDF to Base64 Converter">
    <meta property="og:description" content="Free online tool to convert PDFs to base64 and decode base64 back to PDFs.">

    <!-- Twitter -->
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="PDF to Base64 Converter">
    <meta name="twitter:description" content="Free online tool to convert PDFs to base64 and decode base64 back to PDFs.">

    <link href="https://cdnjs.cloudflare.com/ajax/libs/daisyui/4.7.2/full.min.css" rel="stylesheet" type="text/css" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css" rel="stylesheet">
</head>
<body class="min-h-screen bg-base-300">
    <div class="container mx-auto p-4 max-w-3xl">
        <h1 class="text-3xl font-bold mb-8 text-center">PDF to Base64 Converter</h1>

        <!-- PDF to Base64 Section -->
        <div class="card bg-base-100 shadow-xl mb-8">
            <div class="card-body">
                <h2 class="card-title mb-4">PDF to Base64</h2>
                <div class="form-control">
                    <label class="label">
                        <span class="label-text">Select a PDF file</span>
                    </label>
                    <input type="file" id="pdfInput" accept="application/pdf,.pdf" class="file-input file-input-bordered w-full">
                </div>
                <div id="pdfPreview" class="mt-4 hidden">
                    <label class="label">
                        <span class="label-text">File Info:</span>
                    </label>
                    <div class="p-4 bg-base-200 rounded-lg">
                        <div class="flex items-center gap-3">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 text-error" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z" />
                            </svg>
                            <div id="pdfInfo" class="text-sm"></div>
                        </div>
                    </div>
                </div>
                <button class="btn btn-primary w-full text-white mt-4" id="convertBtn" disabled>Convert to Base64</button>
                <div class="form-control mt-4 hidden" id="base64OutputSection">
                    <label class="label">
                        <span class="label-text">Base64 Output:</span>
                    </label>
                    <textarea id="base64Output" class="textarea textarea-bordered w-full h-48" readonly></textarea>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-2 mt-2">
                        <button class="btn btn-secondary text-white" id="copyBase64Btn">Copy Base64</button>
                        <button class="btn btn-secondary text-white" id="copyDataUrlBtn">Copy Data URL</button>
                    </div>
                    <div id="copyMessage" class="mt-2 min-h-[24px]"></div>
                </div>
            </div>
        </div>

        <!-- Base64 to PDF Section -->
        <div class="card bg-base-100 shadow-xl mb-8">
            <div class="card-body">
                <h2 class="card-title mb-4">Base64 to PDF</h2>
                <div class="form-control">
                    <label class="label">
                        <span class="label-text">Paste Base64 string (with or without data URL prefix)</span>
                    </label>
                    <textarea id="base64Input" placeholder="data:application/pdf;base64,JVBERi0xLj..." class="textarea textarea-bordered w-full h-32"></textarea>
                </div>
                <button class="btn btn-primary w-full text-white mt-4" id="decodeBtn">Decode to PDF</button>
                <div id="decodeError" class="mt-2 text-error hidden"></div>
                <div class="form-control mt-4 hidden" id="decodedPdfSection">
                    <label class="label">
                        <span class="label-text">Decoded PDF:</span>
                    </label>
                    <div class="p-4 bg-base-200 rounded-lg">
                        <div class="flex items-center gap-3">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 text-success" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                            </svg>
                            <div id="decodedPdfInfo" class="text-sm"></div>
                        </div>
                    </div>
                    <button class="btn btn-secondary mt-2 text-white" id="downloadBtn">Download PDF</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Constants
        const BUTTON_DISABLED_COLOR = '#374151'; // Dark gray
        let BUTTON_COLOR; // Will be set on page load

        // Get initial button color
        document.addEventListener('DOMContentLoaded', () => {
            const convertBtn = document.getElementById('convertBtn');
            BUTTON_COLOR = window.getComputedStyle(convertBtn).backgroundColor;
        });

        // Global variables
        let currentPdfFile = null;
        let currentBase64 = null;
        let currentDataUrl = null;

        // Utility Functions
        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return Math.round((bytes / Math.pow(k, i)) * 100) / 100 + ' ' + sizes[i];
        }

        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }

        function animateProgress(button, startTime, duration, progress, color) {
            const currentTime = Date.now();
            const elapsed = currentTime - startTime;
            const progressPercentage = Math.min((elapsed / duration) * 100, progress);

            button.style.background = `linear-gradient(to right, ${color} ${progressPercentage}%, ${BUTTON_DISABLED_COLOR} ${progressPercentage}%)`;

            if (elapsed < duration && progressPercentage < progress) {
                requestAnimationFrame(() => animateProgress(button, startTime, duration, progress, color));
            }
        }

        // PDF to Base64 Functions
        document.getElementById('pdfInput').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (!file) {
                document.getElementById('pdfPreview').classList.add('hidden');
                document.getElementById('convertBtn').disabled = true;
                document.getElementById('base64OutputSection').classList.add('hidden');
                currentPdfFile = null;
                return;
            }

            // Validate file type
            if (file.type !== 'application/pdf' && !file.name.toLowerCase().endsWith('.pdf')) {
                alert('Please select a valid PDF file');
                this.value = '';
                return;
            }

            currentPdfFile = file;

            // Show file info
            document.getElementById('pdfInfo').innerHTML =
                `<strong>${file.name}</strong><br>Size: ${formatFileSize(file.size)}`;
            document.getElementById('pdfPreview').classList.remove('hidden');

            // Enable convert button
            document.getElementById('convertBtn').disabled = false;

            // Hide previous output
            document.getElementById('base64OutputSection').classList.add('hidden');
        });

        document.getElementById('convertBtn').addEventListener('click', async function() {
            if (!currentPdfFile) return;

            const convertBtn = this;
            const base64Output = document.getElementById('base64Output');
            const base64OutputSection = document.getElementById('base64OutputSection');

            convertBtn.disabled = true;
            convertBtn.style.cssText = `
                background: linear-gradient(to right, ${BUTTON_COLOR} 0%, ${BUTTON_DISABLED_COLOR} 0%);
                opacity: 1 !important;
            `;

            const startTime = Date.now();
            const minDuration = 500;

            // Animate to 50%
            animateProgress(convertBtn, startTime, minDuration, 50, BUTTON_COLOR);

            const reader = new FileReader();
            reader.onload = async function(e) {
                currentDataUrl = e.target.result;
                // Extract base64 part (remove data:application/pdf;base64, prefix)
                currentBase64 = currentDataUrl.split(',')[1];

                // Animate to 100%
                animateProgress(convertBtn, startTime, minDuration, 100, BUTTON_COLOR);

                // Wait for minimum duration
                const elapsedTime = Date.now() - startTime;
                if (elapsedTime < minDuration) {
                    await sleep(minDuration - elapsedTime);
                }

                base64Output.value = currentBase64;
                base64OutputSection.classList.remove('hidden');

                convertBtn.style.cssText = `
                    background: ${BUTTON_COLOR};
                    opacity: 1 !important;
                `;
                convertBtn.disabled = false;
            };
            reader.readAsDataURL(currentPdfFile);
        });

        document.getElementById('copyBase64Btn').addEventListener('click', function() {
            const base64Output = document.getElementById('base64Output');
            base64Output.select();
            document.execCommand('copy');

            const copyMessage = document.getElementById('copyMessage');
            copyMessage.textContent = 'Base64 copied to clipboard!';
            copyMessage.className = 'text-success';
            setTimeout(() => {
                copyMessage.textContent = '';
            }, 3000);
        });

        document.getElementById('copyDataUrlBtn').addEventListener('click', function() {
            if (!currentDataUrl) return;

            const textarea = document.createElement('textarea');
            textarea.value = currentDataUrl;
            textarea.style.position = 'fixed';
            textarea.style.opacity = '0';
            document.body.appendChild(textarea);
            textarea.select();
            document.execCommand('copy');
            document.body.removeChild(textarea);

            const copyMessage = document.getElementById('copyMessage');
            copyMessage.textContent = 'Data URL copied to clipboard!';
            copyMessage.className = 'text-success';
            setTimeout(() => {
                copyMessage.textContent = '';
            }, 3000);
        });

        // Base64 to PDF Functions
        document.getElementById('decodeBtn').addEventListener('click', async function() {
            const base64Input = document.getElementById('base64Input');
            const decodeError = document.getElementById('decodeError');
            const decodedPdfSection = document.getElementById('decodedPdfSection');
            const decodeBtn = this;

            let base64String = base64Input.value.trim();

            if (!base64String) {
                decodeError.textContent = 'Please enter a base64 string';
                decodeError.classList.remove('hidden');
                return;
            }

            decodeBtn.disabled = true;
            decodeBtn.style.cssText = `
                background: linear-gradient(to right, ${BUTTON_COLOR} 0%, ${BUTTON_DISABLED_COLOR} 0%);
                opacity: 1 !important;
            `;

            const startTime = Date.now();
            const minDuration = 500;

            // Animate to 50%
            animateProgress(decodeBtn, startTime, minDuration, 50, BUTTON_COLOR);

            try {
                // Check if it's a data URL or just base64
                let dataUrl;
                if (base64String.startsWith('data:')) {
                    dataUrl = base64String;
                } else {
                    dataUrl = `data:application/pdf;base64,${base64String}`;
                }

                // Validate base64 by checking if it starts with PDF header (JVBERi0 = "%PDF-")
                const cleanBase64 = base64String.replace(/^data:application\/pdf;base64,/, '');

                // Try to decode and validate
                try {
                    // Basic validation - check if it's valid base64 and starts with PDF header
                    const binaryString = atob(cleanBase64.substring(0, 100)); // Test first 100 chars
                    if (!binaryString.startsWith('%PDF-')) {
                        throw new Error('Not a valid PDF file');
                    }
                } catch (e) {
                    throw new Error('Invalid base64 or not a PDF file');
                }

                // Animate to 100%
                animateProgress(decodeBtn, startTime, minDuration, 100, BUTTON_COLOR);

                // Wait for minimum duration
                const elapsedTime = Date.now() - startTime;
                if (elapsedTime < minDuration) {
                    await sleep(minDuration - elapsedTime);
                }

                // Store the data URL for download
                currentDataUrl = dataUrl;

                // Calculate approximate file size from base64 length
                const base64Length = cleanBase64.length;
                const sizeInBytes = (base64Length * 3) / 4;

                document.getElementById('decodedPdfInfo').innerHTML =
                    `<strong>PDF Ready</strong><br>Approximate size: ${formatFileSize(sizeInBytes)}`;

                decodedPdfSection.classList.remove('hidden');
                decodeError.classList.add('hidden');

                decodeBtn.style.cssText = `
                    background: ${BUTTON_COLOR};
                    opacity: 1 !important;
                `;
                decodeBtn.disabled = false;

            } catch (error) {
                decodeError.textContent = 'Error decoding base64: ' + error.message;
                decodeError.classList.remove('hidden');
                decodedPdfSection.classList.add('hidden');

                decodeBtn.style.cssText = `
                    background: ${BUTTON_COLOR};
                    opacity: 1 !important;
                `;
                decodeBtn.disabled = false;
            }
        });

        document.getElementById('downloadBtn').addEventListener('click', function() {
            if (!currentDataUrl) return;

            const link = document.createElement('a');
            link.href = currentDataUrl;
            link.download = `decoded-pdf-${Date.now()}.pdf`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        });

        // Input validation for base64 textarea
        document.getElementById('base64Input').addEventListener('input', function() {
            document.getElementById('decodeError').classList.add('hidden');
        });
    </script>
</body>
</html>
